# EVI002 API Verification Tests
# Usage: Install "REST Client" extension in Cursor/VS Code
# Click "Send Request" above each block to execute

@baseUrl = http://localhost:3000
@tenantId = <TENANT_UUID>
@cookie = <PASTE_COOKIE_VALUE>

### Step 4: Create request (empty body)
# @name createRequest
POST {{baseUrl}}/api/requests
Content-Type: application/json
X-Tenant-ID: {{tenantId}}
Cookie: {{cookie}}

{}

### Step 5: Approve request (replace requestId with value from Step 4)
@requestId = <REQUEST_ID_FROM_STEP_4>

POST {{baseUrl}}/api/requests/{{requestId}}/approve
Content-Type: application/json
X-Tenant-ID: {{tenantId}}
Cookie: {{cookie}}

{}

### Step 6: Cross-tenant approve (should return 403 Forbidden)
@otherTenantId = <OTHER_TENANT_UUID>

POST {{baseUrl}}/api/requests/{{requestId}}/approve
Content-Type: application/json
X-Tenant-ID: {{otherTenantId}}
Cookie: {{cookie}}

{}

###############################################################################
# Helper Endpoints
###############################################################################

### Health check (no auth required)
GET {{baseUrl}}/api/health

### Echo test (no auth required)
POST {{baseUrl}}/api/echo
Content-Type: application/json

{
  "test": "hello"
}

### List all requests for tenant
GET {{baseUrl}}/api/requests
Content-Type: application/json
X-Tenant-ID: {{tenantId}}
Cookie: {{cookie}}
